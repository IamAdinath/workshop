name: Deploy Workshop Application

on:
  push:
    branches:
      - master  # Change to your deployment branch

jobs:
  deploy:
    runs-on: ubuntu-latest

    env:
      UI_STACK_NAME: "your-stack-name"
      UI_BUCKET_NAME: "your-s3-bucket-name"
      REGION: "your-aws-region"

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "22"

      - name: change Directory
        run: cd ui/

      - name: Install dependencies
        run: npm install

      - name: Build React app
        run: npm run build

      - name: change directory back
        run: cd ..

      - name: Deploy using script
        run: |
          chmod +x ./ui-deploy.sh
          ./ui-deploy.sh
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          REGION: ${{ secrets.AWS_REGION }}
          UI_STACK_NAME: ${{ env.UI_STACK_NAME }}
          UI_BUCKET_NAME: ${{ env.UI_BUCKET_NAME }}

